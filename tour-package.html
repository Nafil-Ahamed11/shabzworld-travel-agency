<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">

<head>
    <meta charset="utf-8">
    <title>SHABZ WORLD TRAVEL | Tour Packages</title>

    <meta name="author" content="themesflat.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="stylesheet" href="app/css/app.css">
    <link rel="stylesheet" href="app/css/jquery.fancybox.min.css">

    <!-- Favicon and Touch Icons  -->
    <link rel="shortcut icon" href="assests/images/logo/Shabz World Round Logo.png">
    <link rel="apple-touch-icon-precomposed" href="assests/images/logo/Shabz World Round Logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />

</head>

<body class="body header-fixed ">
    <style>
        .tour-listing-image img {
        width: 100%;
        height:300px; 
        object-fit: cover; 
        image-rendering: auto;
        border-radius: 8px;
        }
        
    </style>

    <div class="preload preload-container">
        <svg class="pl" width="240" height="240" viewBox="0 0 240 240">
            <circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
            <circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
        </svg>
    </div>

    <!-- /preload -->

    <div id="wrapper">
        <div id="pagee" class="clearfix">

            <!-- Main Header -->
            <!-- Main Header -->
            <header class="main-header flex">
                <!-- Header Lower -->
                <div id="header">
                    <div class="header-top">
                        <div class="header-top-wrap flex-two">
                            <div class="header-top-right">
                                <ul class="flex-three">
                                    <li class="flex-three">
                                        <i class="fas fa-calendar-day"></i>
                                        <span id="current-date"></span>
                                    </li>
                                    <li class="flex-three">
                                        <i class="fas fa-envelope"></i>
                                        <span>info@shabzworld.com</span>
                                    </li>
                                    <li class="flex-three">
                                        <i class="fas fa-phone"></i>
                                        <span>+971 52 787 1020</span>
                                    </li>
                                </ul>                                                           
                            </div>
                            <div class="header-top-left flex-two">
                                <a href="tour-package-v4.html" class="booking">
                                    <i class="fas fa-calendar-check"></i>
                                    <span>Booking Now</span>
                                </a>
                                <div class="follow-social flex-two">
                                    <span>Follow Us :</span>
                                    <ul class="flex-two">
                                        <li><a href="#"><i class="fab fa-facebook-f"></i></a></li>
                                        <li><a href="#"><i class="fab fa-twitter"></i></a></li>
                                        <li><a href="#"><i class="fab fa-x-twitter"></i></a></li>
                                        <li><a href="#"><i class="fab fa-instagram"></i></a></li>
                                    </ul>
                                </div>

                            </div>
                        </div>

                    </div>
                    <div class="header-lower">
                        <div class="tf-container full">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="inner-container flex justify-space align-center">
                                        <!-- Logo Box -->
                                        <div class="mobile-nav-toggler mobie-mt mobile-button">
                                            <i class="fas fa-bars"></i>
                                        </div>
                                        <div class="logo-box">
                                            <div class="logo ms-5">
                                                <a href="index.html">
                                                    <img src="assests/images/Shabz-World-Normal-Logo-With-Title.png" alt="Logo">
                                                </a>
                                            </div>
                                        </div>
                                        <div class="nav-outer flex align-center">
                                            <!-- Main Menu -->
                                            <nav class="main-menu show navbar-expand-md">
                                                <div class="navbar-collapse collapse clearfix"
                                                    id="navbarSupportedContent">
                                                    <ul class="navigation clearfix">
                                                        <li class="">
                                                            <a href="index.html">Home</a>
                                                        </li>
                                                        <li class="">
                                                            <a href="about-us.html">About</a>
                                                        <li class="current">
                                                            <a href="tour-package.html">Tour Packages</a>
                                                        </li>
                                                        <li class=""><a href="tour-destination.html">Destination</a>
                                                        </li>
                                                        <li class=""><a href="contact.html">Contact</a></li>
                                                    </ul>
                                                </div>
                                            </nav>
                                            <!-- Main Menu End-->
                                        </div>
                                        <div class="header-account flex align-center">
                                            <!-- <div class="language">
                                                <div class="nice-select" tabindex="0">
                                                    <img src="./assets/images/page/language.svg" alt=""><span
                                                        class="current">English</span>
                                                    <ul class="list">
                                                        <li data-value class="option selected"><img
                                                                src="./assets/images/page/language.svg" alt="">English
                                                        </li>
                                                        <li data-value="Vietnam" class="option"><img
                                                                src="./assets/images/page/language.svg" alt="">Vietnam
                                                        </li>
                                                        <li data-value="German" class="option"><img
                                                                src="./assets/images/page/language.svg" alt="">German
                                                        </li>
                                                        <li data-value="Russian" class="option"><img
                                                                src="./assets/images/page/language.svg" alt="">Russian
                                                        </li>
                                                        <li data-value="Canada" class="option"><img
                                                                src="./assets/images/page/language.svg" alt="">Canada
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="search-mobie relative">
                                                <div class="dropdown">
                                                    <a  type="button" class="show-search" data-bs-toggle="dropdown" aria-expanded="false">
                                                        <i class="icon-Vector5"></i>
                                                    </a>
                                                    <ul class="dropdown-menu top-search">
                                                        <form action="/" id="search-bar-widget">
                                                            <input type="text" placeholder="Search here...">
                                                            <button type="button"><i class="icon-search-2"></i></button>
                                                        </form>
                                                    </ul>
                                                  </div> 
                                            </div>
                                            <div class="register">
                                                <ul class="flex align-center">
                                                    <li class="">
                                                        <a href="login.html"><i class="icon-user-1-1"></i>
                                                            <span>Sign in</span>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <img src="./assets/images/page/fl1.png" alt="" class="fly-ab">
                    </div>
                </div>

                <!-- End Header Lower -->
                <!-- <a 
                    href="#" 
                    class="header-sidebar flex-three" 
                    data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasRight" 
                    aria-controls="offcanvasRight"
                >
                    <i class="fas fa-bars"></i>
                </a> -->

                <!-- Mobile Menu  -->
                <div class="close-btn"><span class="icon"><i class="fas fa-times"></i></span></div>
                <div class="mobile-menu">
                    <div class="menu-backdrop"></div>
                    <nav class="menu-box">
                        <div class="nav-logo"><a href="index.html">
                                <img src="assets/images/logo2.png" alt=""></a></div>
                        <div class="bottom-canvas">
                            <div class="menu-outer">
                            </div>
                        </div>
                    </nav>
                </div>
                <!-- End Mobile Menu -->

            </header>
            <!-- End Main Header -->
            <main id="main">

                <section class="breadcumb-section">
                    <div class="tf-container">
                        <div class="row">
                            <div class="col-lg-12 center z-index1">
                                <h1 class="title">Tour Packages</h1>
                                <ul class="breadcumb-list flex-five">
                                    <li><a href="index.html">Home</a></li>
                                    <li><span>Tour Package</span></li>
                                </ul>
                            </div>
                        </div>

                    </div>
                </section>

                <!-- Widget archieve tour -->
                <section class="archieve-tour">
                    <div class="tf-container">
                        <form action="/" class="tf-my-listing1 mb-37">
                            <div class="row align-center">
                                <div class="col-md-8">
                                    <p class="showing">Showing <span id="shown-count" class="text-main">0</span> of <span id="total-count">0</span> Results</p>
                                    <div class="flex-three filter-tour-package">
                                        <div class="nice-select" tabindex="0">
                                            <span class="current">Type</span>
                                            <ul class="list">
                                                <li data-value="" class="option selected focus">Type</li>
                                                <li data-value="type" class="option">Type</li>
                                                <li data-value="type" class="option">Type</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="row" id="tour-container"></div>
                        <div class="row">
                            <div class="col-md-12 ">
                                <ul class="tf-pagination flex-five">
                                </ul>

                            </div>
                        </div>
                </section>
                <!-- Widget archieve tour -->
                <section class="mb--93 bg-1">
                    <div class="tf-container">
                        <div class="callt-to-action flex-two z-index3 relative">
                            <div class="callt-to-action-content flex-three">
                                <div class="image">
                                    <img src="./assests/images/page/ready.png" alt="Image">
                                </div>
                                <div class="content">
                                    <h2 class="title-call">Discover Dubai with Shabz World Tour</h2>
                                    <p class="des">Explore the magic of Dubai with unforgettable experiences curated just for you.</p>
                                </div> 
                            </div>
                            <img src="./assests/images/page/vector4.png" alt="" class="shape-ab">
                            <div class="callt-to-action-button">
                                <a href="tour-package.html" class="get-call">Let,s get started</a>
                            </div>
                        </div>
                    </div>
                </section>
            </main>

            <footer class="footer footer-style1">
                <div class="tf-container">
                    <div class="footer-main">
                        <div class="footer-logo">
                            <div class="logo-footer">
                                <a href="index.html">
                                    <img src="./assests/images/logo/Shabz World Round Logo.png" alt="shabzworld-brand-logo">
                                </a>
                            </div>
                            <p class="des-footer">Let us help you turn your dreams into reality. Your blissful journey begins here.
                        </p>
                            <ul class="footer-info">
                                <li class="flex-three">
                                    <i class="fa-solid fa-envelope"></i>
                                    <p>info@shabzworld.com</p>
                                </li>
                                <li class="flex-three">
                                    <i class="fa-solid fa-phone"></i>
                                    <p>+971 52 787 1020</p>
                                </li>
                                <li class="flex-three">
                                    <i class="fa-solid fa-location-dot"></i>
                                    <p>Expo City, Dubai</p>
                                </li>
                            </ul>
                        </div>
                        <div class="footer-service">
                            <h5 class="title">Services</h5>
                            <ul class="footer-menu">
                                <li>
                                    <a href="index.html">Home</a>
                                </li>
                                <li>
                                    <a href="about-us.html">About Us</a>
                                </li>
                                <li>
                                    <a href="tour-package.html">Tours</a>
                                </li>
                                <li>
                                    <a href="tour-destination.html">Destination</a>
                                </li>
                                <li>
                                    <a href="contact.html">Contact</a>
                                </li>
                            </ul>
                        </div>
                        <div class="footer-disclaimer">
                            <h5 class="title">Disclaimer</h5>
                            <div class="disclaimer-content">
                                <p>All information provided is subject to change without notice. Prices, itineraries, and availability are not guaranteed until booked. Shabz World Tourism is not responsible for any errors, omissions, or changes to services described.</p>
                                <p>Travel requirements such as visas, vaccinations, and COVID-19 protocols are the sole responsibility of the traveler.</p>
                            </div>
                        </div>
                    </div>
                    <div class="row footer-bottom">
                        <div class="col-md-6">
                            <p class="copy-right">
                                Copyright © <span id="currentYear"></span> by <a href="#" class="text-main">SHABZ WORLD TOURISM</a>
                                All Rights Reserved
                            </p>
                        </div>
                        <div class="col-md-6">
                            <ul class="social flex-six">
                                <li>
                                    <a href="#">
                                        <i class="fa-brands fa-facebook-f"></i>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="fa-brands fa-x-twitter"></i>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="fa-brands fa-linkedin-in"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>

            <!-- Bottom -->
        </div>
        <!-- /#page -->
    </div>

    <!-- Modal Popup Bid -->

    <a id="scroll-top" class="button-go">
        <i class="fa-solid fa-arrow-up"></i>
    </a>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight">
        <div class="offcanvas-header">
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="logo-canvas">
                <img src="assests/images/Shabz-World-Normal-Logo-With-Title.png" alt="image">
            </div>
            <p class="des">The world’s first and largest digital market
                for crypto collectibles and non-fungible
            </p>
            <ul class="canvas-info">
                <li class="flex-three">
                    <i class="icon-noun-mail-5780740-1"></i>
                    <p>Info@webmail.com</p>
                </li>
                <li class="flex-three">
                    <i class="icon-Group-9"></i>
                    <p>684 555-0102 490</p>
                </li>
                <li class="flex-three">
                    <i class="icon-Layer-19"></i>
                    <p>6391 Elgin St. Celina, NYC 10299</p>
                </li>
            </ul>
            <ul class="social flex-three">
                <li>
                    <a href="#">
                        <i class="icon-icon-2"></i>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="icon-x"></i>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="icon-8"></i>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="icon-6"></i>
                    </a>
                </li>
            </ul>

        </div>
    </div>

    <!-- Toast Notification -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1100">
        <div id="snackbar" class="toast align-items-center text-white border-0" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div id="snackbarMessage" class="toast-body">
                    <!-- Message will be injected here -->
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <form id="bookingForm" class="modal-content" onsubmit="return validateForm()">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingModalLabel">Book Tour</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Personal Info - Two columns -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="name" class="form-label">Name</label>
                            <input required type="text" class="form-control" id="name" />
                        </div>
                        <div class="col-md-6">
                            <label for="phone" class="form-label">Phone No</label>
                            <input required type="tel" class="form-control" id="phone" />
                        </div>
                    </div>
    
                    <!-- Email and Destination - Two columns -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="email" class="form-label">Email</label>
                            <input required type="email" class="form-control" id="email" />
                        </div>
                        <div class="col-md-6">
                            <label for="modalDestination" class="form-label">Destination</label>
                            <input required type="text" class="form-control" id="modalDestination" readonly />
                        </div>
                    </div>
    
                    <!-- Travel Dates - Two columns -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="departureDate" class="form-label">Departure Date</label>
                            <input required type="date" class="form-control" id="departureDate" />
                        </div>
                        <div class="col-md-6">
                            <label for="arrivalDate" class="form-label">Arrival Date</label>
                            <input required type="date" class="form-control" id="arrivalDate" />
                        </div>
                    </div>
    
                    <!-- Passenger Info -->
                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="passengers" class="form-label">Total Passengers</label>
                            <input type="number" class="form-control" id="passengers" min="1" value="1" required />
                        </div>
                    </div>
    
                    <!-- Adult and Child Counts -->
                    <div id="passengerDetails" class="mb-3">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="adultCount" class="form-label">Adults</label>
                                <input type="number" class="form-control" id="adultCount" name="adults" min="0" value="1" required />
                            </div>
                            <div class="col-md-6">
                                <label for="childCount" class="form-label">Children</label>
                                <input type="number" class="form-control" id="childCount" name="children" min="0" value="0" required />
                            </div>
                        </div>
                        
                        <!-- Error message -->
                        <div id="passengerCountError" class="text-danger mb-3 d-none">
                            Total adults and children must equal the number of passengers.
                        </div>
                    </div>
    
                    <!-- Child age fields container -->
                    <div id="childAgesContainer" class="mb-3"></div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Submit Booking</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        const childAgeValues = {};
        window.updatePassengerDetails = function() {
            const totalPassengers = parseInt(document.getElementById('passengers').value) || 0;
            const passengerDetailsSection = document.getElementById('passengerDetails');
            const adultCountInput = document.getElementById('adultCount');
            const childCountInput = document.getElementById('childCount');
        
            // Show passenger details section if there are passengers
            if (totalPassengers > 0) {
                passengerDetailsSection.classList.remove('d-none');
                
                // Default all passengers to adults initially
                adultCountInput.value = totalPassengers;
                childCountInput.value = 0;
                
                // Set max values for adult and child counts
                adultCountInput.max = totalPassengers;
                childCountInput.max = totalPassengers;
                
                // Clear and hide child ages container
                window.updateChildAgesFields();
            } else {
                passengerDetailsSection.classList.add('d-none');
            }
        
            // Validate after updating
            window.validatePassengerCounts();
        };

        window.validatePassengerCounts = function() {
            const totalPassengers = parseInt(document.getElementById('passengers').value) || 0;
            const adultCount = parseInt(document.getElementById('adultCount').value) || 0;
            const childCount = parseInt(document.getElementById('childCount').value) || 0;
            const errorElement = document.getElementById('passengerCountError');
            
            if (adultCount + childCount !== totalPassengers) {
                errorElement.classList.remove('d-none');
                return false;
            } else {
                errorElement.classList.add('d-none');
                window.updateChildAgesFields();
                return true;
            }
        };

        window.updateChildAgesFields = function() {
            const childCount = parseInt(document.getElementById('childCount').value) || 0;
            const container = document.getElementById('childAgesContainer');
            
            // Clear the container
            container.innerHTML = '';
            
            if (childCount > 0) {
                container.innerHTML = '<h6 class="mt-2">Child Ages</h6>';
                
                // Create a row for every 2 children
                for (let i = 0; i < childCount; i += 2) {
                    const row = document.createElement('div');
                    row.className = 'row mb-2';
                    
                    // Add first child in the row
                    const col1 = document.createElement('div');
                    col1.className = 'col-md-6';
                    
                    // Use the stored value if available
                    const childValue1 = childAgeValues[`childAge${i + 1}`] || '';
                    
                    col1.innerHTML = `
                        <label for="childAge${i + 1}" class="form-label">Child ${i + 1} Age</label>
                        <input required type="number" class="form-control" id="childAge${i + 1}" name="childAge${i + 1}" min="0" max="17" value="${childValue1}" />
                    `;
                    row.appendChild(col1);
                    
                    // Add second child if it exists
                    if (i + 1 < childCount) {
                        const col2 = document.createElement('div');
                        col2.className = 'col-md-6';
                        
                        // Use the stored value if available
                        const childValue2 = childAgeValues[`childAge${i + 2}`] || '';
                        
                        col2.innerHTML = `
                            <label for="childAge${i + 2}" class="form-label">Child ${i + 2} Age</label>
                            <input required type="number" class="form-control" id="childAge${i + 2}" name="childAge${i + 2}" min="0" max="17" value="${childValue2}" />
                        `;
                        row.appendChild(col2);
                    }
                    
                    container.appendChild(row);
                }
                
                // Add event listeners to all child age inputs to store values when changed
                for (let i = 1; i <= childCount; i++) {
                    const input = document.getElementById(`childAge${i}`);
                    if (input) {
                        input.addEventListener('change', function() {
                            const age = this.value;
                            // Store the value for persistence
                            childAgeValues[`childAge${i}`] = age;
                        });
                        
                        // Also store initial value if present
                        if (input.value) {
                            childAgeValues[`childAge${i}`] = input.value;
                        }
                    }
                }
            }
        };

        window.validateForm = function() {
            // First validate passenger counts
            if (!window.validatePassengerCounts()) {
                return false;
            }
            
            // Add any additional validation if needed
            
            return true;
        };

        // Set up event listeners after DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Set up passenger count change handler
            const passengersInput = document.getElementById('passengers');
            if (passengersInput) {
                passengersInput.addEventListener('change', window.updatePassengerDetails);
            }
            
            // Set up adult and child count change handlers
            const adultCountInput = document.getElementById('adultCount');
            const childCountInput = document.getElementById('childCount');
            
            if (adultCountInput) {
                adultCountInput.addEventListener('change', window.validatePassengerCounts);
                
                // Add constraint: adult count changes adjust child count to match total
                adultCountInput.addEventListener('change', function() {
                    const totalPassengers = parseInt(document.getElementById('passengers').value) || 0;
                    const adultCount = parseInt(this.value) || 0;
                    
                    if (adultCount <= totalPassengers) {
                        document.getElementById('childCount').value = totalPassengers - adultCount;
                        window.validatePassengerCounts();
                    }
                });
            }
            
            if (childCountInput) {
                childCountInput.addEventListener('change', window.validatePassengerCounts);
                
                // Add constraint: child count changes adjust adult count to match total
                childCountInput.addEventListener('change', function() {
                    const totalPassengers = parseInt(document.getElementById('passengers').value) || 0;
                    const childCount = parseInt(this.value) || 0;
                    
                    if (childCount <= totalPassengers) {
                        document.getElementById('adultCount').value = totalPassengers - childCount;
                        window.validatePassengerCounts();
                    }
                });
            }
            
            // Initial setup
            window.updatePassengerDetails();
        });

            const dateElement = document.getElementById('current-date');
            const now = new Date();
            const options = {
                weekday: 'long',
                month: 'short',
                day: 'numeric',
                year: 'numeric'
            };
            dateElement.textContent = now.toLocaleDateString('en-US', options);
        
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
            import { 
                getFirestore, 
                collection, 
                getDocs, 
                addDoc,
                query,
                orderBy,
                limit,
                startAfter,
                endBefore,
                limitToLast,
                getCountFromServer,
            } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js";
        
            const firebaseConfig = {
                apiKey: "AIzaSyAqzjDSYawZr9IdPR8Yr5pIhTxdei10DRA",
                authDomain: "travel-agency-3ea70.firebaseapp.com",
                projectId: "travel-agency-3ea70",
                storageBucket: "travel-agency-3ea70.firebasestorage.app",
                messagingSenderId: "630304664282",
                appId: "1:630304664282:web:12a885b210b77cf77f53e3",
                measurementId: "G-GM0QYDSV1F"
            };
        
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);
        
            // Pagination variables
            let lastVisible = null;
            let firstVisible = null;
            let currentPage = 1;
            const itemsPerPage = 8;
            let totalDocs = 0;
            let querySnapshot = null;
        
            const container = document.getElementById("tour-container");
            const paginationElement = document.querySelector(".tf-pagination");
        
            // Booking Modal Functions
            window.openBookingModal = function (destination) {
                document.getElementById("modalDestination").value = destination;
                new bootstrap.Modal(document.getElementById("bookingModal")).show();
            };

            window.getChildAges = function() {
                const childCount = parseInt(document.getElementById('childCount').value) || 0;
                
                const childAges = [];
                
                for (let i = 1; i <= childCount; i++) {
                    const ageInputId = `childAge${i}`;
                    const ageInput = document.getElementById(ageInputId);
                    
                    if (ageInput) {
                        
                        // Get the value and ensure it's a valid number
                        const age = parseInt(ageInput.value);
                        
                        if (!isNaN(age)) {
                            childAges.push(age);
                        } else {
                            // Look for a stored value instead
                            const storedAge = parseInt(childAgeValues[ageInputId]);
                            if (!isNaN(storedAge)) {
                                childAges.push(storedAge);
                            } else {
                                // Push 0 if no value is entered or stored
                                childAges.push(0);
                            }
                        }
                    } else {
                        // If the element doesn't exist but we have a stored value
                        const storedAge = parseInt(childAgeValues[ageInputId]);
                        if (!isNaN(storedAge)) {
                            childAges.push(storedAge);
                        } else {
                            console.error(`Input #${i} element not found and no stored value, skipping`);
                        }
                    }
                }
                
                return childAges;
            };

            window.validateForm = function() {
                // First validate passenger counts
                if (!window.validatePassengerCounts()) {
                    return false;
                }
                
                // Add any additional validation if needed
                
                return true;
            };
        
            document.addEventListener('DOMContentLoaded', ()=>{
                document.getElementById("bookingForm").addEventListener("submit", async (e) => {
                    e.preventDefault();

                    if (!window.validateForm()) {
                        return;
                    }
                
                    const name = document.getElementById("name").value;
                    const phone = document.getElementById("phone").value;
                    const email = document.getElementById("email").value;
                    const destination = document.getElementById("modalDestination").value;
                    const departureDate = new Date(document.getElementById("departureDate").value);
                    const arrivalDate = new Date(document.getElementById("arrivalDate").value);
                    const totalPassengers = parseInt(document.getElementById("passengers").value);
                    const adultCount = parseInt(document.getElementById("adultCount").value);
                    const childCount = parseInt(document.getElementById("childCount").value);

                    const childAges = window.getChildAges();
                    const formattedChildAges = childAges.length > 0 ? childAges.join(', ') : '0';
                
                    const bookingData = {
                        name,
                        phone,
                        email,
                        destination,
                        departureDate: departureDate.toISOString(),
                        arrivalDate: arrivalDate.toISOString(),
                        totalPassengers,
                        adultCount,
                        childCount,
                        childAges: formattedChildAges,
                        createdAt: new Date()
                    };
            
                    try {
                        await addDoc(collection(db, "bookings"), bookingData);
                        
                        const formUrl = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLSeA52TaM4bloaYRDmGuyBgooCrDTvefZ2sCGZZdMOhLvLg3yg/formResponse';
                        const formData = new FormData();
                        formData.append('entry.543094476', name); 
                        formData.append('entry.534350288', destination); 
                        formData.append('entry.1250227044', phone);
                        formData.append('entry.1424151992', totalPassengers); 
                        formData.append('entry.893270675', email);
                        formData.append('entry.1454716324_year', arrivalDate.getFullYear());
                        formData.append('entry.1454716324_month', arrivalDate.getMonth() + 1);
                        formData.append('entry.1454716324_day', arrivalDate.getDate());
                        formData.append('entry.609456838_year', departureDate.getFullYear());
                        formData.append('entry.609456838_month', departureDate.getMonth() + 1);
                        formData.append('entry.609456838_day', departureDate.getDate());
                        formData.append('entry.405154481', formattedChildAges);
                        formData.append('entry.1612655512', adultCount);
                        formData.append('entry.114164941', childCount);
            
                        await fetch(formUrl, {
                            method: 'POST',
                            mode: 'no-cors',
                            body: formData
                        });
            
                        document.getElementById("bookingForm").reset();
                        bootstrap.Modal.getInstance(document.getElementById("bookingModal")).hide();
                        showSnackbar("Booking submitted successfully!");
            
                    } catch (error) {
                        showSnackbar("Error submitting booking: " + error.message, true);
                    }
                });
            })

            function updateResultsCount(shown, total) {
                document.getElementById('shown-count').textContent = shown;
                document.getElementById('total-count').textContent = total;
            }

            async function loadTours(direction = 'next') {
                try {
                    container.innerHTML = '';
                    let q;

                    const toursRef = collection(db, "tourPackages");
                    const baseQuery = query(toursRef, orderBy("title"), limit(itemsPerPage));
                    
                    if (direction === 'next' && lastVisible) {
                        q = query(toursRef, orderBy("title"), startAfter(lastVisible), limit(itemsPerPage));
                    } else if (direction === 'prev' && firstVisible) {
                        q = query(toursRef, orderBy("title"), endBefore(firstVisible), limitToLast(itemsPerPage));
                    } else {
                        q = baseQuery;
                    }

                    // Get the total count of documents in the collection
                    const totalCountSnapshot = await getCountFromServer(collection(db, "tourPackages"));
                    const totalCount = totalCountSnapshot.data().count;

                    querySnapshot = await getDocs(q);
                    const currentShown = querySnapshot.docs.length;

                    if (querySnapshot.docs.length > 0) {
                        firstVisible = querySnapshot.docs[0];
                        lastVisible = querySnapshot.docs[querySnapshot.docs.length - 1];
                    }

                    querySnapshot.forEach((doc) => {
                        const tour = doc.data();
                        container.innerHTML += `
                            <div class="col-sm-6 col-xl-3 mb-32">
                                <div class="tour-listing box-sd">
                                    <a href="" class="tour-listing-image">
                                        <img src="${tour.image}" alt="${tour.alt}" loading="lazy" class="img-fluid">
                                    </a>
                                    <div class="tour-listing-content">
                                        <span class="map"><i class="fas fa-map-marker-alt"></i>${tour.location}</span>
                                        <div class="review">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <span>(1 Review)</span>
                                        </div>
                                        <h3 class="title-tour-list"><a href="">${tour.title}</a></h3>
                                        <button class="btn btn-success mt-3 w-100" onclick="openBookingModal('${tour.title}')">Book Now</button>
                                    </div>
                                </div>
                            </div>
                        `;
                    });

                    // Update the count displays
                    updateResultsCount(currentShown, totalCount);
                    
                    updatePaginationControls();
                } catch (error) {
                    console.error("Error loading tours:", error);
                    showSnackbar("Error loading tours: " + error.message, true);
                }
            }
                    
            function updatePaginationControls() {
                paginationElement.innerHTML = `
                    <li>
                        <a class="pages-link prev-btn" href="#" ${currentPage === 1 ? 'disabled' : ''}>
                            <i class="icon-29"></i>
                        </a>
                    </li>
                    <li class="pages-item active">
                        <span class="pages-link">${currentPage}</span>
                    </li>
                    <li>
                        <a class="pages-link next-btn" href="#" ${totalDocs < itemsPerPage ? 'disabled' : ''}>
                            <i class="icon--1"></i>
                        </a>
                    </li>
                `;
        
                document.querySelector('.prev-btn')?.addEventListener('click', previousPage);
                document.querySelector('.next-btn')?.addEventListener('click', nextPage);
            }
        
            function nextPage(e) {
                e.preventDefault();
                if (totalDocs === itemsPerPage) {
                    currentPage++;
                    loadTours('next');
                }
            }
        
            function previousPage(e) {
                e.preventDefault();
                if (currentPage > 1) {
                    currentPage--;
                    loadTours('prev');
                }
            }
    
        function showSnackbar(message, isError = false) {
            const snackbar = document.getElementById('snackbar');
            const messageEl = document.getElementById('snackbarMessage');
    
            messageEl.textContent = message;
            snackbar.classList.remove('bg-success', 'bg-danger');
            snackbar.classList.add(isError ? 'bg-danger' : 'bg-success');
    
            const toast = new bootstrap.Toast(snackbar);
            toast.show();
        }
    
        // Initial load
        loadTours();
    </script>
    <!-- Javascript -->
    <script src="app/js/jquery.min.js"></script>
    <script src="app/js/jquery.nice-select.min.js"></script>
    <script src="app/js/bootstrap.min.js"></script>
    <script src="app/js/swiper-bundle.min.js"></script>
    <script src="app/js/swiper.js"></script>
    <script src="app/js/plugin.js"></script>
    <script src="app/js/jquery.fancybox.js"></script>
    <script src="app/js/price-ranger.js"></script>
    <script src="app/js/shortcodes.js"></script>
    <script src="app/js/main.js"></script>

</body>

</html>